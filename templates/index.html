<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diet Tracker</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Track your nutrition and fuel your gains">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Diet Tracker">
    <meta name="msapplication-TileColor" content="#667eea">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iNDAiIGZpbGw9InVybCgjZ3JhZGllbnQwX2xpbmVhcl8xXzEpIi8+CjxwYXRoIGQ9Ik05NiA0OEM3OC4zIDQ4IDY0IDYyLjMgNjQgODBWNjRIMTI4VjgwQzEyOCA2Mi4zIDExMy43IDQ4IDk2IDQ4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTk2IDE0NEM3OC4zIDE0NCA2NCAxNTguMyA2NCAxNzZIMTI4QzEyOCAxNTguMyAxMTMuNyAxNDQgOTYgMTQ0WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTE0NCA4MEg0OEM0My42IDgwIDQwIDgzLjYgNDAgODhWMTQ0QzQwIDE0OC40IDQzLjYgMTUyIDQ4IDE1MkgxNDRDMTQ4LjQgMTUyIDE1MiAxNDguNCAxNTIgMTQ0Vjg4QzE1MiA4My42IDE0OC40IDgwIDE0NCA4MFoiIGZpbGw9IndoaXRlIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50MF9saW5lYXJfMV8xIiB4MT0iMCIgeTE9IjAiIHgyPSIxOTIiIHkyPSIxOTIiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzY2N2VlYSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM3NjRiYTIiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-btn active" onclick="showScreen('add', this)">
            <span class="nav-icon">‚ûï</span>
            <span class="nav-label">Add</span>
        </button>
        <button class="nav-btn" onclick="showScreen('totals', this)">
            <span class="nav-icon">üìä</span>
            <span class="nav-label">Totals</span>
        </button>
        <button class="nav-btn" onclick="showScreen('log', this)">
            <span class="nav-icon">üçé</span>
            <span class="nav-label">Log</span>
        </button>
        <button class="nav-btn" onclick="showScreen('progress', this)">
            <span class="nav-icon">üìà</span>
            <span class="nav-label">Progress</span>
        </button>
        <button class="nav-btn" onclick="toggleTheme()" id="theme-toggle">
            <span class="nav-icon">üåô</span>
            <span class="nav-label">Theme</span>
        </button>
    </nav>

    <!-- Add Food Screen -->
    <div id="add-screen" class="screen active">
        <div class="container">
            <h1>üçé Add Food</h1>
            <p>Enter food in natural language</p>
            
            <div class="input-section">
                <input type="text" id="foodInput" placeholder="e.g., 200g chicken breast, 2 apples" />
                <button onclick="addFood()" class="add-btn">Add Food</button>
            </div>
            
            <div class="extracted-foods">
                <h3>Extracted Foods</h3>
                <div id="extractedFoodsContainer" class="extracted-container">
                    <div class="extracted-placeholder">Food will appear here as it's processed...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Totals Screen -->
    <div id="totals-screen" class="screen">
        <div class="container">
            <h1>üìä Daily Totals</h1>
            
            <div class="totals-section">
                <div class="total-card">
                    <div class="total-icon">üî•</div>
                    <div class="total-content">
                        <span class="total-label">Calories</span>
                        <span class="total-value">{{ "%.0f"|format(totals.calories) }}</span>
                    </div>
                </div>
                
                <div class="macros-grid">
                    <div class="macro-item">
                        <span class="macro-icon">ü•©</span>
                        <span class="macro-label">Protein</span>
                        <span class="macro-value">{{ "%.1f"|format(totals.protein) }}g</span>
                    </div>
                    <div class="macro-item">
                        <span class="macro-icon">üçû</span>
                        <span class="macro-label">Carbs</span>
                        <span class="macro-value">{{ "%.1f"|format(totals.carbs) }}g</span>
                    </div>
                    <div class="macro-item">
                        <span class="macro-icon">ü•ë</span>
                        <span class="macro-label">Fat</span>
                        <span class="macro-value">{{ "%.1f"|format(totals.fat) }}g</span>
                    </div>
                    <div class="macro-item">
                        <span class="macro-icon">üåæ</span>
                        <span class="macro-label">Fiber</span>
                        <span class="macro-value">{{ "%.1f"|format(totals.fiber) }}g</span>
                    </div>
                </div>
            </div>
            
            <div class="stats-section">
                <h3>Today's Stats</h3>
                <div class="stat-item">
                    <span>Food Items:</span>
                    <span class="stat-value">{{ food_log|length }}</span>
                </div>
                <div class="stat-item">
                    <span>Avg per Item:</span>
                    <span class="stat-value">{{ "%.0f"|format(totals.calories / food_log|length if food_log|length > 0 else 0) }} cal</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Food Log Screen -->
    <div id="log-screen" class="screen">
        <div class="container">
            <div class="log-header">
                <h1>üçé Food Log</h1>
                <button onclick="clearLog()" class="clear-btn">Clear All</button>
            </div>
            
            <div class="food-list">
                {% for food in food_log %}
                <div class="food-item" data-food-index="{{ loop.index0 }}">
                    <div class="food-main">
                        <div class="food-name">{{ food.food_name }}</div>
                        <div class="food-amount">
                            {% if food.grams > 0 %}
                                {{ food.grams }}g
                            {% endif %}
                            {% if food.quantity_items > 0 %}
                                {{ food.quantity_items }} items
                            {% endif %}
                        </div>
                    </div>
                    {% if food.nutrition %}
                    <div class="nutrition-compact">
                        <span class="nutrition-badge">üî• {{ "%.0f"|format(food.nutrition.calories) }}</span>
                        <span class="nutrition-badge">ü•© {{ "%.1f"|format(food.nutrition.protein) }}g</span>
                        <span class="nutrition-badge">üçû {{ "%.1f"|format(food.nutrition.carbs) }}g</span>
                        <span class="nutrition-badge">ü•ë {{ "%.1f"|format(food.nutrition.fat) }}g</span>
                    </div>
                    {% endif %}
                    <div class="food-input">{{ food.raw_input }}</div>
                    <div class="delete-overlay">
                        <div class="delete-button">üóëÔ∏è Delete</div>
                    </div>
                </div>
                {% endfor %}
                
                {% if food_log|length == 0 %}
                <div class="empty-state">
                    <div class="empty-icon">üçΩÔ∏è</div>
                    <div class="empty-text">No food logged yet</div>
                    <div class="empty-subtext">Add your first meal!</div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Progress Screen -->
    <div id="progress-screen" class="screen">
        <div class="container">
            <h1>üìà Your Progress</h1>
            
            <!-- Streak Card -->
            <div class="streak-card">
                <div class="streak-icon">üî•</div>
                <div class="streak-content">
                    <div class="streak-number" id="streak-number">0</div>
                    <div class="streak-label">Day Streak</div>
                </div>
            </div>
            
            <!-- Weekly Averages -->
            <div class="averages-section">
                <h3>Weekly Averages</h3>
                <div class="averages-grid">
                    <div class="average-item">
                        <div class="average-icon">üî•</div>
                        <div class="average-value" id="avg-calories">0</div>
                        <div class="average-label">Calories</div>
                    </div>
                    <div class="average-item">
                        <div class="average-icon">ü•©</div>
                        <div class="average-value" id="avg-protein">0g</div>
                        <div class="average-label">Protein</div>
                    </div>
                    <div class="average-item">
                        <div class="average-icon">üçû</div>
                        <div class="average-value" id="avg-carbs">0g</div>
                        <div class="average-label">Carbs</div>
                    </div>
                    <div class="average-item">
                        <div class="average-icon">ü•ë</div>
                        <div class="average-value" id="avg-fat">0g</div>
                        <div class="average-label">Fat</div>
                    </div>
                </div>
            </div>
            
            <!-- Weekly Chart -->
            <div class="chart-section">
                <h3>7-Day Overview</h3>
                <div class="chart-container">
                    <canvas id="progressChart" width="400" height="200"></canvas>
                </div>
            </div>
            
            <!-- Daily Breakdown -->
            <div class="daily-breakdown">
                <h3>Daily Breakdown</h3>
                <div class="daily-list" id="daily-list">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
